
<!DOCTYPE html> 
<html lang="es">
<head>
    <!-- Inserted by miarroba -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7294310421616689" crossorigin="anonymous"></script>
    <script type='text/javascript' src='https://ads.vidoomy.com/miarroba_23335.js' async></script>
    <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];
      w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
      var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
      j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
      f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T2VG59');
    </script>
    <!-- Inserted by miarroba -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA CRADO POR GELM----TRANSPORTES-PMT--TODOS LOS DERECHOS RESERVADOS</title>

    <!-- Librería XLSX -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

    <!-- MODO DIOS: FONDO NEROX -->
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            color: #eee;
            /* Fondo tipo TRON / NEROX GOD MODE */
            background: radial-gradient(circle at 20% 0%, rgba(0,255,255,0.2), transparent 50%),
                        radial-gradient(circle at 80% 0%, rgba(255,0,255,0.18), transparent 55%),
                        #05010a;
            background-attachment: fixed;
            animation: fondoGlow 6s ease-in-out infinite alternate;
        }

        @keyframes fondoGlow {
            0%   { box-shadow: inset 0 0 20px #ff00ff; }
            50%  { box-shadow: inset 0 0 80px #00ffff; }
            100% { box-shadow: inset 0 0 120px #ff00ff; }
        }

        .contenedor {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.82);
            border-radius: 18px;
            padding: 20px;
            box-shadow:
                0 0 18px rgba(0,255,255,0.5),
                0 0 50px rgba(0,0,0,1);
            border: 1px solid rgba(0,255,255,0.35);
        }

        /* ====== ENCABEZADO + LOGOS ====== */
        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo-box {
            flex: 0 0 auto;
            padding: 6px;
            border-radius: 14px;
            background: radial-gradient(circle at 30% 0, rgba(0,255,120,0.3), rgba(0,255,255,0.05));
            box-shadow:
                0 0 10px rgba(0,255,120,0.9),
                0 0 25px rgba(0,0,0,0.9);
            border: 1px solid rgba(0,255,180,0.9);
        }

        .logo-box img {
            display: block;
            max-width: 110px;
            height: auto;
        }

        .titulos {
            flex: 1 1 auto;
            text-align: center;
        }

        .titulos-linea1 {
            font-size: 20px;
            font-weight: bold;
            color: #00ffc8;
            text-shadow: 0 0 10px #00ffff, 0 0 25px #0044ff;
            letter-spacing: 1px;
        }

        .titulos-linea2 {
            font-size: 15px;
            margin-top: 4px;
            color: #ffdf5e;
            text-shadow: 0 0 6px #000;
        }

        .titulos-linea3 {
            font-size: 14px;
            margin-top: 3px;
            color: #a5ffe5;
            text-shadow: 0 0 6px #00ffea;
        }

        .titulos-linea4 {
            font-size: 13px;
            margin-top: 4px;
            color: #cccccc;
        }

        #estado {
            text-align: center;
            margin: 12px 0 15px 0;
            font-size: 14px;
            color: #aaa;
        }

        .buscador {
            max-width: 700px;
            margin: 0 auto 20px auto;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .buscador input {
            padding: 10px 12px;
            font-size: 16px;
            border-radius: 999px;
            border: 1px solid #00ffc8;
            min-width: 230px;
            outline: none;
            background: #050513;
            color: #00ffc8;
            box-shadow: 0 0 10px rgba(0,255,255,0.5);
        }

        .buscador input::placeholder {
            color: #66ffe6;
        }

        .buscador button {
            padding: 10px 22px;
            font-size: 16px;
            border-radius: 999px;
            border: none;
            background: radial-gradient(circle at 30% 0, #00ffff, #5f00ff);
            color: #000;
            font-weight: bold;
            cursor: pointer;
            text-shadow: 0 0 4px #00ffea;
            box-shadow:
                0 0 10px rgba(0,255,255,0.8),
                0 0 26px rgba(0,0,0,0.9);
        }

        .buscador button:hover {
            filter: brightness(1.1);
        }

        #resultado {
            max-width: 100%;
            overflow-x: auto;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 10px;
            background: #141414;
        }

        th, td {
            border: 1px solid #333;
            padding: 6px 8px;
            font-size: 13px;
            text-align: left;
        }

        th {
            background: #00ffc8;
            color: #000;
        }

        tr:nth-child(even) td {
            background: #101010;
        }

        .nota {
            text-align: center;
            font-size: 12px;
            color: #bbb;
            margin-top: 8px;
        }

        /* ===== BOTÓN HOLOGRÁFICO CONTACTO ===== */
        .contacto-wrapper {
            margin-top: 18px;
            text-align: center;
        }

        .btn-contacto {
            position: relative;
            display: inline-block;
            padding: 10px 26px;
            border-radius: 999px;
            border: 1px solid #00ffc8;
            background: transparent;
            color: #a8ffe8;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            overflow: hidden;
            text-shadow: 0 0 4px #000;
            box-shadow:
                0 0 14px rgba(0,255,255,0.7),
                0 0 30px rgba(0,0,0,1);
        }

        .btn-contacto span.icono {
            margin-right: 6px;
        }

        .btn-contacto::before {
            content: "";
            position: absolute;
            inset: -2px;
            background: linear-gradient(120deg,
                        rgba(0,255,255,0),
                        rgba(0,255,180,0.8),
                        rgba(0,255,255,0));
            opacity: 0.35;
            transform: translateX(-100%);
            animation: scan 3s linear infinite;
            pointer-events: none;
        }

        .btn-contacto::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            box-shadow: 0 0 20px rgba(0,255,120,0.4);
            opacity: 0;
            transition: opacity 0.25s ease-out;
        }

        .btn-contacto:hover::after {
            opacity: 1;
        }

        @keyframes scan {
            0%   { transform: translateX(-120%); }
            100% { transform: translateX(120%); }
        }

        /* ===== SIMILARES ===== */
        .similares-box {
            margin-top: 10px;
            text-align: left;
            font-size: 12px;
            color: #a8ffe8;
        }

        .similares-box label {
            margin-right: 6px;
            font-weight: bold;
        }

        .similares-box select {
            background: #020b40;
            color: #ffffff;
            border-radius: 999px;
            border: 1px solid #00ffc8;
            padding: 5px 10px;
            min-width: 250px;
        }

        /* ===== FOOTER FECHA/HORA ===== */
        .footer-info {
            margin-top: 18px;
            text-align: center;
            font-size: 12px;
            color: #4ee8ff;
            text-shadow: 0 0 8px #00fff2;
        }

        .footer-info strong {
            color: #7bffb2;
        }

        @media(max-width: 768px){
            .contenedor {
                padding: 14px;
            }
            .header-top {
                flex-direction: column;
            }
            .logo-box img {
                max-width: 95px;
            }
            .titulos-linea1 {
                font-size: 18px;
            }
            .titulos-linea2 {
                font-size: 14px;
            }
            .titulos-linea3,
            .titulos-linea4 {
                font-size: 12px;
            }
        }

        @media(max-width: 480px){
            .buscador {
                flex-direction: column;
            }
            .buscador button {
                width: 100%;
                max-width: 260px;
            }
            .btn-contacto {
                width: 100%;
                max-width: 280px;
            }
        }
    </style>
</head>
<body>
<!-- Inserted by miarroba -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T2VG59" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- Inserted by miarroba -->

<div class="contenedor">

    <!-- ENCABEZADO CON LOGOS -->
    <div class="header-top">
        <div class="logo-box">
            <img src="https://gelm2mil.github.io/sistema/icons/YO.png" alt="Logo GELM">
        </div>

        <div class="titulos">
            <div class="titulos-linea1">SISTEMA DE GELM -PMT- CHIMALTENANGO</div>
            <div class="titulos-linea2">DELEGACIÓN DE TRANSPORTES</div>
            <div class="titulos-linea3">Sistema de Consulta 2014 - 2025 ? == BY GELM == ?</div>
            <div class="titulos-linea4">Buscador de vehiculos o lineas Autorizadas con registro en esta jefatura 2025</div>
        </div>

        <div class="logo-box">
            <img src="https://gelm2mil.github.io/sistema/icons/YO.png" alt="Logo GELM">
        </div>
    </div>

    <div id="estado">Cargando archivo Excel...</div>

    <div class="buscador">
        <input id="busquedaInput" type="text"
               placeholder="Placa, DPI, No. licencia, documento o No. de calcomanía...">
        <button onclick="buscar()">Buscar</button>
    </div>

    <p class="nota">
        Puedes escribir con o sin espacios / guiones. Ej:<br>
        <b>1856 12258 0413</b> ó <b>1856122580413</b> &nbsp; | &nbsp;
        <b>1056-12250413</b> ó <b>105612250413</b> &nbsp; | &nbsp;
        <b>40</b> (No. calcomanía)
    </p>

    <div id="resultado">
        <div id="resultado-principal"></div>
        <div id="similares-contenedor"></div>
    </div>

    <!-- BOTÓN HOLOGRÁFICO CONTACTO -->
    <div class="contacto-wrapper">
        <button class="btn-contacto" onclick="window.location.href='mailto:nerox2mil@proton.me'">
            <span class="icono">??</span>
            <span>Más información / Contactar a GELM</span>
        </button>
    </div>

    <!-- FOOTER FECHA/HORA -->
    <div class="footer-info">
        <div>2014 - 2025 | <strong>BY GELM</strong> | Delegación de Transportes PMT - Chimaltenango<br>
        att: ---[GELM]---</div>
        <div id="fechaHora"></div>
    </div>

</div>

<script>
let registros = [];
let similares = []; // para el desplegable

// ========== CARGAR EXCEL ==========
async function cargarExcel() {
    try {
        const resp = await fetch("2025.xlsx");   // Debe estar en la misma carpeta que este HTML
        if (!resp.ok) throw new Error("No se pudo descargar 2025.xlsx");

        const data = await resp.arrayBuffer();
        const wb = XLSX.read(data, { type: "array" });

        const hoja = wb.Sheets[wb.SheetNames[0]];
        const filas = XLSX.utils.sheet_to_json(hoja, { header: 1, raw: false });

        // Buscar la primera fila con una placa (M-...)
        let inicio = filas.findIndex(f =>
            (f[0] || "").toString().trim().toUpperCase().startsWith("M-")
        );
        if (inicio === -1) {
            document.getElementById("estado").textContent =
                "No se encontraron registros de placas en el Excel.";
            return;
        }

        for (let i = inicio; i < filas.length; i++) {
            const f = filas[i];
            if (!f[0]) continue; // fila vacía

            registros.push({
                placa:        (f[0]  || "").trim().toUpperCase(),  // A
                calcomania:   (f[1]  || "").trim(),                // B
                placaSale:    (f[2]  || "").trim(),                // C
                concesionario:(f[3]  || "").trim(),                // D
                telDueno:     (f[4]  || "").trim(),                // E
                ruta:         (f[5]  || "").trim(),                // F
                telPilotos:   (f[6]  || "").trim(),                // G
                nombrePiloto: (f[7]  || "").trim(),                // H
                dpi:          (f[8]  || "").trim(),                // I
                documento:    (f[9]  || "").trim(),                // J
                licencia:     (f[10] || "").trim().toUpperCase(), // K
                tipoLic:      (f[11] || "").trim()                 // L
            });
        }

        document.getElementById("estado").textContent =
            "Archivo cargado. Registros: " + registros.length;
    } catch (err) {
        console.error(err);
        document.getElementById("estado").textContent = "Error: " + err.message;
    }
}

// ========== NORMALIZAR (quita espacios y guiones) ==========
function normalizar(txt) {
    return txt.toString()
              .replace(/\s+/g, "")
              .replace(/-/g, "")
              .trim()
              .toUpperCase();
}

// Pequeño escape para HTML
function esc(str) {
    return str
        .toString()
        .replace(/&/g,"&amp;")
        .replace(/</g,"&lt;")
        .replace(/>/g,"&gt;")
        .replace(/"/g,"&quot;");
}

// Construye la tabla HTML de un registro
function construirTabla(r) {
    if (!r) return "";
    return `
        <table>
            <tr>
                <th>NO. PLACA</th>
                <th>NO. CALCOMANIA</th>
                <th>PLACA SALE</th>
                <th>CONCESIONARIO (A)</th>
                <th>TEL. DUEÑO</th>
                <th>RUTA</th>
                <th>TEL. PILOTOS</th>
                <th>NOMBRE DEL PILOTO</th>
                <th>DPI</th>
                <th>DOCUMENTO</th>
                <th>NUMERO DE LICENCIA</th>
                <th>TIPO LICENCIA</th>
            </tr>
            <tr>
                <td>${esc(r.placa)}</td>
                <td>${esc(r.calcomania)}</td>
                <td>${esc(r.placaSale)}</td>
                <td>${esc(r.concesionario)}</td>
                <td>${esc(r.telDueno)}</td>
                <td>${esc(r.ruta)}</td>
                <td>${esc(r.telPilotos)}</td>
                <td>${esc(r.nombrePiloto)}</td>
                <td>${esc(r.dpi)}</td>
                <td>${esc(r.documento)}</td>
                <td>${esc(r.licencia)}</td>
                <td>${esc(r.tipoLic)}</td>
            </tr>
        </table>
    `;
}

// ========== BUSCAR ==========
function buscar() {
    const texto = document.getElementById("busquedaInput").value.trim();
    const valorMayus = texto.toUpperCase();
    const limpio = normalizar(texto);

    const divPrincipal = document.getElementById("resultado-principal");
    const divSimilares = document.getElementById("similares-contenedor");

    divSimilares.innerHTML = "";
    similares = [];

    if (!texto) {
        divPrincipal.innerHTML = "<p>Escribe placa, DPI, número de licencia, documento o No. de calcomanía.</p>";
        return;
    }

    // Reunimos TODAS las coincidencias con prioridad
    const coincidencias = [];

    registros.forEach(reg => {
        let prioridad = 0;

        // Número de calcomanía exacto
        if (reg.calcomania === texto || reg.calcomania === limpio) {
            // Damos prioridad más alta a CASCO/URBANO (mototaxis base)
            const rutaMayus = reg.ruta.toUpperCase();
            if (rutaMayus.includes("CASCO")) {
                prioridad = 100;
            } else {
                prioridad = 90;
            }
        }

        // Placa
        if (reg.placa === valorMayus) {
            prioridad = Math.max(prioridad, 80);
        }

        // DPI
        if (normalizar(reg.dpi) === limpio) {
            prioridad = Math.max(prioridad, 70);
        }

        // Licencia
        if (normalizar(reg.licencia) === limpio) {
            prioridad = Math.max(prioridad, 60);
        }

        // Documento
        if (normalizar(reg.documento) === limpio) {
            prioridad = Math.max(prioridad, 50);
        }

        if (prioridad > 0) {
            coincidencias.push({ reg, prioridad });
        }
    });

    if (coincidencias.length === 0) {
        divPrincipal.innerHTML = `<p>No se encontró <strong>${esc(texto)}</strong>.</p>`;
        return;
    }

    // Ordenamos por prioridad (descendente)
    coincidencias.sort((a, b) => b.prioridad - a.prioridad);

    const principal = coincidencias[0].reg;
    const otros = coincidencias.slice(1).map(c => c.reg);
    similares = otros; // almacenamos para el select

    // Mostramos el principal
    divPrincipal.innerHTML = construirTabla(principal);

    // Si hay más resultados, mostramos desplegable "SIMILARES"
    if (otros.length > 0) {
        let opciones = '<option value="">-- seleccionar --</option>';
        otros.forEach((r, idx) => {
            const desc = `Calcomanía ${r.calcomania} ? ${r.ruta} ? ${r.placa}`;
            opciones += `<option value="${idx}">${esc(desc)}</option>`;
        });

        divSimilares.innerHTML = `
            <div class="similares-box">
                <label for="similaresSelect">SIMILARES:</label>
                <select id="similaresSelect" onchange="mostrarSimilar(this.value)">
                    ${opciones}
                </select>
            </div>
        `;
    }
}

// Cambiar a otro registro similar desde el select
function mostrarSimilar(indice) {
    const i = parseInt(indice, 10);
    if (isNaN(i) || !similares[i]) return;
    const divPrincipal = document.getElementById("resultado-principal");
    divPrincipal.innerHTML = construirTabla(similares[i]);
}

// ========== RELOJ EN FOOTER ==========
function actualizarFechaHora() {
    const ahora = new Date();
    const opciones = {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric"
    };
    const fecha = ahora.toLocaleDateString("es-ES", opciones);
    const hora = ahora.toLocaleTimeString("es-ES");
    const el = document.getElementById("fechaHora");
    if (el) {
        el.textContent = fecha + " ? " + hora;
    }
}
setInterval(actualizarFechaHora, 1000);
actualizarFechaHora();

// Iniciar carga de Excel al entrar
cargarExcel();
</script>

<!-- Inserted by miarroba -->
</script></noframes></noembed></noscript>
<script type="text/javascript" src="/hosting__contador__visitas__unicas.php?h=2204386&amp;t=1763949688&amp;k=4ab2767312a69326a334b11deace8108&amp;__muid="></script>
<!-- Inserted by miarroba -->
</body>
</html>
